# ğŸ‘ ç»ƒä¹ 

ç°åœ¨æ˜¯ç»ƒä¹ ä½ æ‰€å­¦æ¦‚å¿µçš„æ—¶å€™äº†ï¼å°è¯•å°½ä½ æ‰€èƒ½å›ç­”ä»¥ä¸‹é—®é¢˜ã€‚å¯ä»¥å‚è€ƒä½ åœ¨è¯¾ç¨‹ä¸­æŸ¥çœ‹çš„å¹»ç¯ç‰‡å’Œè®°å½•çš„ç¬”è®°ã€‚

ä¸è¦ä½œå¼Šï¼å°½é‡åœ¨å°è¯•å›ç­”åå†æŸ¥çœ‹ç­”æ¡ˆã€‚

## æ·»åŠ æ¨¡ç³Šæœç´¢

å°è¯•åœ¨ä½ çš„åº”ç”¨ä¸­æ·»åŠ æ¨¡ç³Šæœç´¢åŠŸèƒ½ï¼Œä»¥ä¾¿å³ä½¿ç”¨æˆ·è¾“å…¥æœ‰æ‹¼å†™é”™è¯¯ä¹Ÿèƒ½æ‰¾åˆ°æ­£ç¡®çš„ä¹¦ç±ã€‚

:::tip
è¿˜è®°å¾— [`text`](https://www.mongodb.com/docs/atlas/atlas-search/text/#std-label-text-ref) æ“ä½œç¬¦çš„ `fuzzy` å‚æ•°å—ï¼Ÿå°±æ˜¯åœ¨è¿™é‡Œä½¿ç”¨å®ƒã€‚
:::

<details>
  <summary>ç­”æ¡ˆ</summary>
  <div>

```js
public async searchBooks(query: string): Promise<Book[]> {
  const aggregationPipeline = [
      {
          $search: {
              index: 'fulltextsearch',
              text: {
                  query,
                  path: ['title', 'authors.name', 'genres'],
                  fuzzy: {
                    maxEdits: 2
                  }
              }
          }
      }
  ];
  const books = await collections?.books?.aggregate(aggregationPipeline).toArray() as Book[];
  return books;
}
```

  </div>
</details>

## æ¨å¹¿æœˆåº¦æ¨èä¹¦ç±

å¸‚åœºå›¢é˜Ÿå†³å®šè¦æ¨å¹¿æœˆåº¦æ¨èä¹¦ç±ã€‚ä»–ä»¬å¸Œæœ›åœ¨æœç´¢ç»“æœä¸­é¦–å…ˆæ˜¾ç¤ºè¿™äº›ä¹¦ç±ã€‚ä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ

:::tip
ä½ éœ€è¦åœ¨è¿™é‡Œä½¿ç”¨ [`compound`](https://www.mongodb.com/docs/atlas/atlas-search/compound/#std-label-compound-ref) æ“ä½œç¬¦å’Œå¤šä¸ªæ“ä½œç¬¦ã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸€äº›ä¹¦ç±ä¸Šçš„ `bookOfTheMonth` å¸ƒå°”å­—æ®µã€‚
:::

<details>
  <summary>ç­”æ¡ˆ</summary>
  <div>

```js
public async searchBooks(query: string): Promise<Book[]> {
    const aggregationPipeline = [
        {
          $search: {
            "index": "fulltextsearch",
            "compound": {
              "must": [
                {
                  "text": {
                    query,
                    "path": ["title", "authors.name", "genres"],
                    fuzzy: {
                      maxEdits: 2
                    }
                  }
                }
              ],
              "should": [
                {
                  "equals": {
                    "value": true,
                    "path": "bookOfTheMonth",
                    "score": {
                      "boost": { value: 10 }
                    }
                  }
                }
              ]
            }
          }
        }
      ];
    const books = await collections?.books?.aggregate(aggregationPipeline).toArray() as Book[];
    return books;
}
```

  </div>
</details>